<div class="playground-container">
  <!-- Header del playground -->
  <div class="playground-header">
    <div class="header-info">
      <h2 class="heading-3">🧪 Playground Python - Árboles de Decisión</h2>
      <p class="section-description">
        Editor de código interactivo con <strong>WebAssembly</strong> para experimentar con árboles de decisión en tiempo real.
      </p>
      <div *ngIf="selectedExample && exampleInfo[selectedExample]" class="current-example">
        <span class="example-badge">{{ exampleInfo[selectedExample].title }}</span>
        <span class="example-description">{{ exampleInfo[selectedExample].description }}</span>
      </div>
    </div>
    <div class="playground-status">
      <div class="status-indicator" [class.ready]="isReady" [class.loading]="isLoading">
        <span class="status-dot"></span>
        <span class="status-text">{{ statusText }}</span>
      </div>
    </div>
  </div>

  <!-- Layout del editor -->
  <div class="editor-layout">
    <!-- Panel izquierdo: Editor -->
    <div class="editor-panel">
      <div class="panel-header">
        <h3>📝 Editor de Código</h3>
        <div class="editor-controls">
          <button
            class="btn btn-sm"
            (click)="loadExample()"
            [disabled]="!isReady"
            title="Cargar ejemplo">
            📁 Ejemplo
          </button>
          <button
            class="btn btn-sm"
            (click)="clearEditor()"
            [disabled]="!isReady"
            title="Limpiar editor">
            🗑️ Limpiar
          </button>
          <button
            class="btn btn-sm"
            (click)="formatCode()"
            [disabled]="!isReady"
            title="Formatear código">
            ✨ Formatear
          </button>
        </div>
      </div>

      <!-- Contenedor del editor Monaco -->
      <div class="editor-container">
        <div #editorContainer class="monaco-editor-container"></div>
      </div>

      <!-- Botón de ejecución -->
      <div class="execution-controls">
        <button
          class="btn btn-primary btn-lg"
          (click)="runCode()"
          [disabled]="!isReady || isExecuting"
          [class.loading]="isExecuting">
          <span *ngIf="!isExecuting">🚀 Ejecutar Código</span>
          <span *ngIf="isExecuting">
            <span class="loading-spinner"></span>
            Ejecutando...
          </span>
        </button>
      </div>
    </div>

    <!-- Panel derecho: Resultados -->
    <div class="results-panel">
      <div class="panel-header">
        <h3>📊 Resultados</h3>
        <div class="results-controls">
          <button
            class="btn btn-sm"
            (click)="clearResults()"
            [disabled]="!hasResults"
            title="Limpiar resultados">
            🧹 Limpiar
          </button>
        </div>
      </div>

      <!-- Área de resultados -->
      <div class="results-container">
        <div
          class="results-content"
          [class.empty]="!hasResults"
          [class.error]="hasError">

          <!-- Estado inicial -->
          <div *ngIf="!hasResults && !isExecuting" class="empty-state">
            <div class="empty-icon">🎯</div>
            <h4>¡Ejecuta tu código!</h4>
            <p>Los resultados aparecerán aquí después de ejecutar el código Python.</p>
          </div>

          <!-- Resultados exitosos -->
          <div *ngIf="hasResults && !hasError" class="success-results">
            <div class="output-section">
              <h5>✅ Salida del programa:</h5>
              <pre class="output-content">{{ executionOutput }}</pre>
            </div>
          </div>

          <!-- Errores -->
          <div *ngIf="hasError" class="error-results">
            <div class="error-section">
              <h5>❌ Error en la ejecución:</h5>
              <pre class="error-content">{{ executionError }}</pre>
            </div>
            <div *ngIf="executionOutput" class="output-section">
              <h5>📝 Salida parcial:</h5>
              <pre class="output-content">{{ executionOutput }}</pre>
            </div>
          </div>

          <!-- Indicador de carga -->
          <div *ngIf="isExecuting" class="loading-results">
            <div class="loading-animation">
              <div class="loading-spinner"></div>
              <p>Ejecutando código Python...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Sección de ejemplos -->
  <div class="examples-section">
    <h3 class="heading-4">💡 Ejemplos de Árboles de Decisión</h3>
    <div class="examples-grid">
      <div class="example-card" (click)="loadExample('basic')">
        <div class="example-icon">🌳</div>
        <h4>Básico</h4>
        <p>Introducción a árboles de decisión con dataset Iris</p>
      </div>

      <div class="example-card" (click)="loadExample('advanced')">
        <div class="example-icon">📊</div>
        <h4>Avanzado</h4>
        <p>Análisis detallado con matriz de confusión e importancia</p>
      </div>

      <div class="example-card" (click)="loadExample('comparison')">
        <div class="example-icon">⚖️</div>
        <h4>Comparación</h4>
        <p>Comparar árboles con otros algoritmos de ML</p>
      </div>

      <div class="example-card" (click)="loadExample('visualization')">
        <div class="example-icon">📈</div>
        <h4>Visualización</h4>
        <p>Entender las reglas de decisión paso a paso</p>
      </div>

      <div class="example-card" (click)="loadExample('interactive')">
        <div class="example-icon">🎮</div>
        <h4>Interactivo</h4>
        <p>Experimenta con diferentes ejemplos de clasificación</p>
      </div>
    </div>
  </div>
</div>
